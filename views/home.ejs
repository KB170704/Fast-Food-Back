<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Admin Dashboard</title>
    <link
      href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css"
      rel="stylesheet"
    />
    <script
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.10.3/dist/cdn.min.js"
      defer
    ></script>
    <style>
      body {
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
      }
      .sidebar {
        width: 250px;
        background-color: #1f2937;
        min-height: 100vh;
        color: white;
      }
      .sidebar a {
        display: block;
        padding: 12px 20px;
        color: white;
        text-decoration: none;
      }
      .sidebar a:hover {
        background-color: #374151;
      }
      .content {
        margin-left: 250px;
        padding: 2rem;
      }
      .card {
        background: white;
        border-radius: 12px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        padding: 1.5rem;
        margin-bottom: 2rem;
      }
    </style>
  </head>
  <body class="bg-gray-100">
    <div class="flex">
      <!-- Sidebar -->
      <div class="sidebar fixed">
        <h2 class="text-2xl font-bold p-6 border-b border-gray-700">
          Dashboard
        </h2>
        <nav>
          <a href="/home">🏠 Home</a>
          <a href="#gallery">📷 Gallery</a>
          <a href="#menu">🍽️ Menu</a>
          <a href="#users">👥 Users</a>
          <a href="#contacts">📩 Contacts</a>
          <a href="#orders">💸 Orders</a>
          <a href="https://kaushik-six.vercel.app/">🏠 front end</a>
          <a href="/login">Login</a>
        </nav>
      </div>

      <!-- Main Content -->
      <div class="content w-full">
        <!-- Gallery Section -->
        <section id="gallery" class="card mb-10">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-semibold text-blue-800">
              📸 Gallery Items
            </h2>
            <a
              href="/gallery/add"
              class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"
              >+ Add New</a
            >
          </div>
          <% if (galleryItems.length === 0) { %>
          <p class="text-gray-600">No gallery items found.</p>
          <% } else { %>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <% galleryItems.forEach(item => { %>
            <div class="bg-white rounded-lg shadow p-4">
              <img
                src="/<%= item.image %>"
                alt="<%= item.name %>"
                class="w-full h-40 object-cover rounded mb-2"
              />
              <h3 class="text-lg font-bold text-blue-700"><%= item.name %></h3>
              <p class="text-gray-600 text-sm"><%= item.description %></p>
              <div class="flex justify-between mt-2">
                <a
                  href="/gallery/edit/<%= item._id %>"
                  class="bg-yellow-400 text-black px-3 py-1 rounded hover:bg-yellow-500 text-sm"
                  >✏️ Edit</a
                >
                <form
                  action="/gallery/<%= item._id %>?_method=DELETE"
                  method="POST"
                >
                  <button
                    type="submit"
                    class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm"
                  >
                    🗑️ Delete
                  </button>
                </form>
              </div>
            </div>
            <% }) %>
          </div>
          <% } %>
        </section>

        <!-- Menu Section -->
        <section id="menu" class="card mb-10">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-semibold text-blue-800">🍽️ Menu Items</h2>
            <a
              href="/menu/create"
              class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"
              >+ Add New</a
            >
          </div>
          <% if (menuItems.length === 0) { %>
          <p class="text-gray-600">No menu items found.</p>
          <% } else { %>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <% menuItems.forEach(item => { %>
            <div class="bg-white rounded-lg shadow p-4 text-center">
              <% if (item.photo) { %>
              <img
                src="<%= item.photo %>"
                alt="<%= item.Name %>"
                class="w-full h-40 object-cover rounded mb-2"
              />
              <% } %>
              <h3 class="text-lg font-bold text-blue-700"><%= item.Name %></h3>
              <p class="text-gray-600 text-sm"><%= item.Description %></p>
              <p class="text-sm font-semibold mt-1">₹<%= item.price %></p>
              <p
                class="text-xs mt-1 bg-blue-100 text-blue-800 inline-block px-2 py-1 rounded-full"
              >
                <%= item.category %>
              </p>
              <div class="flex justify-between mt-2">
                <a
                  href="/menu/edit/<%= item._id %>"
                  class="bg-yellow-400 text-black px-3 py-1 rounded hover:bg-yellow-500 text-sm"
                  >✏️ Edit</a
                >
                <a
                  href="/menu/delete/<%= item._id %>"
                  class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm"
                  onclick="return confirm('Are you sure you want to delete this item?');"
                  >🗑️ Delete</a
                >
              </div>
            </div>
            <% }) %>
          </div>
          <% } %>
        </section>

        <!-- User Section -->
        <section id="users" class="card mb-10">
          <div class="flex justify-between items-center mb-4">
            <h2 class="text-xl font-semibold text-blue-800">
              👥 Registered Users
            </h2>
            <a
              href="/user/add"
              class="bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700"
              >+ Add New User</a
            >
          </div>
          <% if (users.length === 0) { %>
          <p class="text-gray-600">No users registered yet.</p>
          <% } else { %>
          <div class="overflow-auto">
            <table class="min-w-full bg-white rounded shadow">
              <thead class="bg-blue-100 text-blue-800">
                <tr>
                  <th class="px-4 py-2 text-left">Name</th>
                  <th class="px-4 py-2 text-left">Email</th>
                  <th class="px-4 py-2 text-left">Contact</th>
                  <th class="px-4 py-2 text-left">Role</th>
                  <th class="px-4 py-2 text-left">Registered At</th>
                  <th class="px-4 py-2 text-left">Actions</th>
                </tr>
              </thead>
              <tbody>
                <% users.forEach(user => { %>
                <tr class="border-b hover:bg-gray-50">
                  <td class="px-4 py-2">
                    <%= user.firstName %> <%= user.lastName %>
                  </td>
                  <td class="px-4 py-2"><%= user.email %></td>
                  <td class="px-4 py-2"><%= user.contact %></td>
                  <td class="px-4 py-2 capitalize"><%= user.role %></td>
                  <td class="px-4 py-2">
                    <%= new Date(user.createdAt).toLocaleDateString() %>
                  </td>
                  <td class="px-4 py-2 flex gap-2">
                    <a
                      href="/user/edit/<%= user._id %>"
                      class="bg-yellow-400 text-black px-3 py-1 rounded hover:bg-yellow-500 text-sm"
                      >✏️ Edit</a
                    >
                    <a
                      href="/user/delete/<%= user._id %>"
                      class="bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600 text-sm"
                      onclick="return confirm('Are you sure you want to delete this user?');"
                      >🗑️ Delete</a
                    >
                  </td>
                </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
          <% } %>
        </section>

        <!-- Contact Section -->
        <section id="contacts" class="card mb-10">
          <h2 class="text-xl font-semibold text-blue-800 mb-4">
            📨 Contact Submissions
          </h2>
          <% contacts.forEach(contact => { %>
          <div class="bg-white rounded shadow p-4 mb-4">
            <p><strong>Name:</strong> <%= contact.name %></p>
            <p><strong>Email:</strong> <%= contact.email %></p>
            <p>
              <strong>Message:</strong>
              <span class="block text-sm text-gray-700 mt-1"
                ><%= contact.message %></span
              >
            </p>
            <p class="text-xs text-gray-500 mt-2">
              Submitted at: <%= new Date(contact.createdAt).toLocaleString() %>
            </p>
          </div>
          <% }); %>
        </section>

        <!-- Orders Section -->
        <section id="orders" class="card mb-10">
          <h2 class="text-xl font-semibold text-blue-800 mb-4">
            💰 Payment Orders
          </h2>
          <% if (orders.length === 0) { %>
          <p class="text-gray-600">No orders found.</p>
          <% } else { %>
          <div class="overflow-auto">
            <table class="min-w-full bg-white rounded shadow">
              <thead class="bg-orange-100 text-orange-800">
                <tr>
                  <th class="p-3 text-left">Name</th>
                  <th class="p-3 text-left">Email</th>
                  <th class="p-3 text-left">Address</th>
                  <th class="p-3 text-left">Payment</th>
                  <th class="p-3 text-left">Amount</th>
                  <th class="p-3 text-left">Status</th>
                  <th class="p-3 text-left">Action</th>
                </tr>
              </thead>
              <tbody>
                <% orders.forEach(order => { %>
                <tr class="border-b hover:bg-gray-50">
                  <td class="p-3"><%= order.firstName %></td>
                  <td class="p-3"><%= order.email %></td>
                  <td class="p-3"><%= order.address %></td>
                  <td class="p-3"><%= order.paymentMethod %></td>
                  <td class="p-3">₹<%= order.totalAmount.toFixed(2) %></td>
                  <td class="p-3">
                    <span
                      class="px-2 py-1 rounded-full text-xs <%= order.status === 'Delivered' ? 'bg-green-100 text-green-700' : 'bg-yellow-100 text-yellow-700' %>"
                    >
                      <%= order.status %>
                    </span>
                  </td>
                  <td class="p-3">
                    <form
                      action="/payment/order/<%= order._id %>/status"
                      method="POST"
                    >
                      <input
                        type="hidden"
                        name="status"
                        value="<%= order.status === 'Pending' ? 'Delivered' : 'Pending' %>"
                      />
                      <button
                        type="submit"
                        class="bg-orange-500 hover:bg-orange-600 text-white text-sm px-3 py-1 rounded"
                      >
                        Mark as <%= order.status === 'Pending' ? 'Delivered' :
                        'Pending' %>
                      </button>
                    </form>
                  </td>
                </tr>
                <% }) %>
              </tbody>
            </table>
          </div>
          <% } %>
        </section>
      </div>
    </div>
  </body>
</html>
